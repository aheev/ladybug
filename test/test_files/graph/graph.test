-DATASET CSV empty

--

-CASE CreateGraphAndUseGraph
-SKIP_FSM_LEAK_CHECK
-LOG This test creates per-graph StorageManagers which allocate pages from the main database's
-LOG buffer manager. The FSM leak check expects all pages to be accounted for in the main database
-LOG header, but pages from per-graph storage managers may not be properly reclaimed during
-LOG checkpoint. This needs further debugging to properly track and reclaim pages across all
-LOG per-graph storage managers.

-LOG CreateGraph
-STATEMENT CREATE GRAPH graph1_cgu
---- ok

-LOG UseGraph
-STATEMENT USE GRAPH graph1_cgu
---- ok

-LOG CreateTableInGraph1
-STATEMENT CREATE NODE TABLE test(id INT64, name STRING, PRIMARY KEY(id))
---- ok

-LOG CreateSecondGraph
-STATEMENT CREATE GRAPH graph2_cgu
---- ok

-LOG UseSecondGraph
-STATEMENT USE GRAPH graph2_cgu
---- ok

-LOG CreateTableInGraph2
-STATEMENT CREATE NODE TABLE test(id INT64, name STRING, PRIMARY KEY(id))
---- ok

-LOG CleanupGraph2
-STATEMENT DROP TABLE test
---- ok

-LOG SwitchToGraph1
-STATEMENT USE GRAPH graph1_cgu
---- ok

-LOG CleanupGraph1
-STATEMENT DROP TABLE test
---- ok

-CASE VerifyCatalogIsolation
-LOG CreateGraphsForIsolationTest
-STATEMENT CREATE GRAPH graph1_vci
---- ok

-STATEMENT CREATE GRAPH graph2_vci
---- ok

-LOG VerifyTablesInDifferentCatalogs
-STATEMENT USE GRAPH graph1_vci
---- ok

-STATEMENT CREATE NODE TABLE test(id INT64, name STRING, PRIMARY KEY(id))
---- ok

-STATEMENT USE GRAPH graph2_vci
---- ok

-STATEMENT CREATE NODE TABLE test(id INT64, name STRING, PRIMARY KEY(id))
---- ok

-LOG VerifySwitchingWorks
-STATEMENT USE GRAPH graph1_vci
---- ok

-STATEMENT USE GRAPH graph2_vci
---- ok

-STATEMENT USE GRAPH graph1_vci
---- ok

-LOG CleanupGraph2
-STATEMENT USE GRAPH graph2_vci
---- ok

-STATEMENT DROP TABLE test
---- ok

-LOG CleanupGraph1
-STATEMENT USE GRAPH graph1_vci
---- ok

-STATEMENT DROP TABLE test
---- ok

-LOG CleanupAllGraphs
-STATEMENT DROP GRAPH graph2_vci
---- ok

-STATEMENT DROP GRAPH graph1_vci
---- ok

-CASE ShowTablesWithIsolation
-LOG CreateTablesInDifferentGraphs
-STATEMENT CREATE NODE TABLE person(id INT64, name STRING, PRIMARY KEY(id))
---- ok

-STATEMENT CREATE GRAPH foo1
---- ok

-STATEMENT USE GRAPH foo1
---- ok

-STATEMENT CREATE NODE TABLE person(id INT64, name STRING, PRIMARY KEY(id))
---- ok

-LOG VerifyShowTables
-STATEMENT CALL show_tables() RETURN name, `database name`
---- 2
person|main(graph)
person|foo1(graph)

-LOG CleanupFoo1
-STATEMENT DROP TABLE person
---- ok

-STATEMENT DROP GRAPH foo1
---- ok

-CASE ErrorCases
-LOG DuplicateGraphError
-STATEMENT CREATE GRAPH graph1_ec
---- ok

-STATEMENT CREATE GRAPH graph1_ec
---- error
Runtime exception: Graph graph1_ec already exists.

-LOG NonExistentGraphError
-STATEMENT USE GRAPH nonexistent
---- error
Binder exception: No graph named nonexistent.

-LOG UseLocal
-STATEMENT USE GRAPH main
---- ok

-LOG Cleanup
-STATEMENT DROP GRAPH graph1_ec
---- ok

-CASE DropGraph
-LOG CreateGraphsToDrop
-STATEMENT CREATE GRAPH graph1_dg
---- ok

-STATEMENT CREATE GRAPH graph2_dg
---- ok

-STATEMENT CREATE GRAPH graph3_dg
---- ok

-LOG UseFirstGraph
-STATEMENT USE GRAPH graph1_dg
---- ok

-LOG DropSecondGraph
-STATEMENT DROP GRAPH graph2_dg
---- ok

-LOG VerifyGraph2Dropped
-STATEMENT USE GRAPH graph2_dg
---- error
Binder exception: No graph named graph2_dg.

-LOG DropNonExistentGraph
-STATEMENT DROP GRAPH nonexistent
---- error
Binder exception: Graph nonexistent does not exist.

-LOG DropGraphIfExists
-STATEMENT DROP GRAPH IF EXISTS nonexistent
---- ok

-LOG DropGraphInUse
-STATEMENT CREATE GRAPH testgraph_dg
---- ok

-STATEMENT USE GRAPH testgraph_dg
---- ok

-STATEMENT DROP GRAPH testgraph_dg
---- ok

-LOG VerifySwitchedToLocal
-STATEMENT USE GRAPH testgraph_dg
---- error
Binder exception: No graph named testgraph_dg.

-LOG DropOthertest
-STATEMENT CREATE GRAPH dummy1_dg
---- ok

-STATEMENT CREATE GRAPH dummy2_dg
---- ok

-STATEMENT USE GRAPH dummy1_dg
---- ok

-STATEMENT DROP GRAPH dummy2_dg
---- ok

-STATEMENT USE GRAPH dummy1_dg
---- ok

-STATEMENT DROP GRAPH dummy1_dg
---- ok
